<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>JatƒÅ PƒÅ·π≠ha</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="jata-content">
  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-icon">üîó</div>
    <h1 class="hero-title">JatƒÅ PƒÅ·π≠ha</h1>
    <h2 class="hero-sanskrit">‡§ú‡§ü‡§æ ‡§™‡§æ‡§†</h2>
    <p class="hero-description">
      The Braided Recitation Method - Master the most intricate Vedic memorization technique through complex interwoven patterns that create unbreakable memory bonds
    </p>
  </div>

  <!-- Introduction Section -->
  <div class="introduction-section">
    <div class="intro-header">
      <ion-icon name="library-outline"></ion-icon>
      <h2>Understanding JatƒÅ PƒÅ·π≠ha</h2>
    </div>
    
    <div class="intro-content">
      <div class="definition-card">
        <h3>
          <ion-icon name="git-branch-outline"></ion-icon>
          Definition
        </h3>
        <p>
          JatƒÅ (‡§ú‡§ü‡§æ) means "braid" or "matted hair" like that of Lord Shiva. This method creates intricate patterns where words are woven together in complex sequences, resembling the braided structure of hair.
        </p>
        <p>
          This is considered one of the most sophisticated Vedic recitation methods, requiring mastery of simpler techniques before attempting the braided patterns.
        </p>
      </div>

      <div class="purpose-card">
        <h3>
          <ion-icon name="diamond-outline"></ion-icon>
          Spiritual & Cognitive Benefits
        </h3>
        <p>The braided recitation method offers profound benefits:</p>
        <ul>
          <li>Develops exceptional concentration and mental discipline</li>
          <li>Creates multiple memory pathways for perfect retention</li>
          <li>Enhances understanding through complex pattern recognition</li>
          <li>Builds cognitive flexibility and mental agility</li>
          <li>Prepares the mind for the ultimate Ghana PƒÅ·π≠ha method</li>
          <li>Deepens spiritual connection through intricate sacred patterns</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Method Explanation Section -->
  <div class="method-section">
    <h2>The Braided Pattern Method</h2>
    
    <div class="method-example">
      <div class="example-header">
        <h3>Example: Bhagavad Gƒ´tƒÅ 2.47 (First Line)</h3>
        <div class="original-line">
          <div class="line-devanagari">‡§ï‡§∞‡•ç‡§Æ‡§£‡•ç‡§Ø‡•á‡§µ‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡§∏‡•ç‡§§‡•á ‡§Æ‡§æ ‡§´‡§≤‡•á‡§∑‡•Å ‡§ï‡§¶‡§æ‡§ö‡§®</div>
          <div class="line-roman">karma·πáy-evƒÅdhikƒÅras-te mƒÅ phale·π£u kadƒÅcana</div>
          <div class="word-breakdown">
            <span class="word-tag">‡§ï‡§∞‡•ç‡§Æ‡§£‡§ø (1)</span>
            <span class="word-tag">‡§è‡§µ (2)</span>
            <span class="word-tag">‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: (3)</span>
            <span class="word-tag">‡§§‡•á (4)</span>
            <span class="word-tag">‡§Æ‡§æ (5)</span>
            <span class="word-tag">‡§´‡§≤‡•á‡§∑‡•Å (6)</span>
            <span class="word-tag">‡§ï‡§¶‡§æ‡§ö‡§® (7)</span>
          </div>
        </div>
      </div>

      <div class="jata-sequence">
        <div class="sequence-title">
          <ion-icon name="git-branch-outline"></ion-icon>
          <h4>JatƒÅ Pattern Sequence</h4>
        </div>
        
        <div class="pattern-explanation">
          <div class="pattern-card">
            <h4>The Braided Formula</h4>
            <p>For words 1, 2, 3: <strong>1-2, 2-1, 1-2-3, 3-2-1, 1-2-3</strong></p>
            <p>This creates a "braid" where each sequence loops back and forward, creating an intricate pattern.</p>
          </div>
        </div>

        <div class="sequence-steps">
          <div class="sequence-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <div class="step-pattern">Tri-Word Braid Pattern (Words 1-2-3)</div>
              <div class="step-recitation">
                <div class="recite-item pair">‡§ï‡§∞‡•ç‡§Æ‡§£‡§ø ‡§è‡§µ</div>
                <div class="recite-item pair-reverse">‡§è‡§µ ‡§ï‡§∞‡•ç‡§Æ‡§£‡§ø</div>
                <div class="recite-item triplet">‡§ï‡§∞‡•ç‡§Æ‡§£‡§ø ‡§è‡§µ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞:</div>
                <div class="recite-item triplet-reverse">‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: ‡§è‡§µ ‡§ï‡§∞‡•ç‡§Æ‡§£‡§ø</div>
                <div class="recite-item triplet">‡§ï‡§∞‡•ç‡§Æ‡§£‡§ø ‡§è‡§µ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞:</div>
              </div>
            </div>
          </div>

          <div class="sequence-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <div class="step-pattern">Next Tri-Word Braid (Words 2-3-4)</div>
              <div class="step-recitation">
                <div class="recite-item pair">‡§è‡§µ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞:</div>
                <div class="recite-item pair-reverse">‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: ‡§è‡§µ</div>
                <div class="recite-item triplet">‡§è‡§µ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: ‡§§‡•á</div>
                <div class="recite-item triplet-reverse">‡§§‡•á ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: ‡§è‡§µ</div>
                <div class="recite-item triplet">‡§è‡§µ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: ‡§§‡•á</div>
              </div>
            </div>
          </div>

          <div class="sequence-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <div class="step-pattern">Continuing Braid (Words 3-4-5)</div>
              <div class="step-recitation">
                <div class="recite-item pair">‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: ‡§§‡•á</div>
                <div class="recite-item pair-reverse">‡§§‡•á ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞:</div>
                <div class="recite-item triplet">‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: ‡§§‡•á ‡§Æ‡§æ</div>
                <div class="recite-item triplet-reverse">‡§Æ‡§æ ‡§§‡•á ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞:</div>
                <div class="recite-item triplet">‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞: ‡§§‡•á ‡§Æ‡§æ</div>
              </div>
            </div>
          </div>
        </div>

        <div class="benefits-highlight">
          <h4>Why the Braided Pattern Works</h4>
          <div class="benefits-grid">
            <div class="benefit-item">
              <ion-icon name="repeat-outline" color="primary"></ion-icon>
              <span>Repetitive reinforcement</span>
            </div>
            <div class="benefit-item">
              <ion-icon name="swap-horizontal-outline" color="primary"></ion-icon>
              <span>Forward-reverse training</span>
            </div>
            <div class="benefit-item">
              <ion-icon name="link-outline" color="primary"></ion-icon>
              <span>Interconnected memory</span>
            </div>
            <div class="benefit-item">
              <ion-icon name="shield-checkmark-outline" color="success"></ion-icon>
              <span>Error-proof recitation</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Training Modes Section -->
  <div class="training-modes-section">
    <h2>JatƒÅ Training Methods</h2>
    
    <div class="modes-grid">
      <ion-card class="mode-card" (click)="selectMode('guided')">
        <div class="mode-icon">
          <ion-icon name="school-outline" color="primary"></ion-icon>
        </div>
        <h3>Guided Learning</h3>
        <p>Step-by-step introduction to braided patterns with detailed explanations and visual cues</p>
        <div class="mode-features">
          <span>Pattern visualization</span>
          <span>Audio guidance</span>
          <span>Progress tracking</span>
        </div>
      </ion-card>

      <ion-card class="mode-card" (click)="selectMode('pattern-practice')">
        <div class="mode-icon">
          <ion-icon name="git-branch-outline" color="warning"></ion-icon>
        </div>
        <h3>Pattern Practice</h3>
        <p>Master individual braid patterns before combining them into complete sequences</p>
        <div class="mode-features">
          <span>Isolated patterns</span>
          <span>Repetition training</span>
          <span>Mastery verification</span>
        </div>
      </ion-card>

      <ion-card class="mode-card" (click)="selectMode('speed-building')">
        <div class="mode-icon">
          <ion-icon name="speedometer-outline" color="tertiary"></ion-icon>
        </div>
        <h3>Speed Building</h3>
        <p>Gradually increase recitation speed while maintaining accuracy and pattern integrity</p>
        <div class="mode-features">
          <span>Tempo progression</span>
          <span>Fluency development</span>
          <span>Rhythm training</span>
        </div>
      </ion-card>

      <ion-card class="mode-card" (click)="selectMode('memory-challenge')">
        <div class="mode-icon">
          <ion-icon name="trophy-outline" color="success"></ion-icon>
        </div>
        <h3>Memory Challenge</h3>
        <p>Test complete mastery with complex sequences and pattern variations</p>
        <div class="mode-features">
          <span>Advanced patterns</span>
          <span>Timed challenges</span>
          <span>Mastery assessment</span>
        </div>
      </ion-card>
    </div>
  </div>

  <!-- Sloka Selection Section -->
  <div class="sloka-selection-section" *ngIf="selectedMode">
    <h2>Choose Your Practice Sloka</h2>
    
    <div class="sloka-cards">
      <ion-card class="sloka-card" *ngFor="let sloka of availableSlokas" (click)="selectSloka(sloka)">
        <ion-card-header>
          <ion-card-title>{{ sloka.reference }}</ion-card-title>
          <ion-card-subtitle>{{ sloka.title }}</ion-card-subtitle>
        </ion-card-header>
        <ion-card-content>
          <div class="sloka-info">
            <div class="word-count">
              <ion-icon name="text-outline"></ion-icon>
              <span>{{ sloka.totalWords }} words</span>
            </div>
            <div class="difficulty" [class]="sloka.difficulty">
              <ion-icon name="star-outline"></ion-icon>
              <span>{{ sloka.difficulty }}</span>
            </div>
          </div>
          <p>{{ sloka.meaning }}</p>
          <div class="pattern-preview">
            <div class="pattern-count">{{ sloka.braidPatterns }} Braid Patterns</div>
          </div>
        </ion-card-content>
      </ion-card>
    </div>
  </div>

  <!-- Training Interface -->
  <div class="training-interface" *ngIf="selectedSloka && !isCompleted">
    <div class="training-header">
      <h3>{{ selectedMode | titlecase }} Training</h3>
      <div class="training-progress">
        <div class="progress-info">
          <span>Pattern {{ currentPatternIndex + 1 }} of {{ totalPatterns }}</span>
          <span class="progress-percentage">{{ getProgressPercentage() }}% Complete</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="getProgressPercentage()"></div>
        </div>
      </div>
    </div>

    <!-- Current Pattern Section -->
    <div class="current-pattern-section">
      <div class="pattern-header">
        <h4>Current Braid Pattern</h4>
        <div class="pattern-type" [class]="currentPattern?.type">
          <ion-icon [name]="getPatternIcon()"></ion-icon>
          <span>{{ currentPattern?.type | titlecase }} Pattern</span>
        </div>
      </div>

      <div class="pattern-display">
        <div class="pattern-content">
          <div class="pattern-instruction">{{ currentPattern?.instruction }}</div>
          
          <div class="current-recitation">
            <div class="recitation-text">{{ currentPattern?.currentStep?.text }}</div>
            <div class="recitation-roman">{{ currentPattern?.currentStep?.roman }}</div>
          </div>

          <div class="word-highlight">
            Focusing on: <span class="highlighted-words">{{ currentPattern?.focusWords }}</span>
          </div>
        </div>

        <div class="pattern-controls">
          <div class="audio-controls">
            <ion-button fill="outline" (click)="playAudio()" [disabled]="isPlayingAudio">
              <ion-icon name="play-outline" slot="start"></ion-icon>
              {{ isPlayingAudio ? 'Playing...' : 'Play Audio' }}
            </ion-button>
            <ion-button fill="outline" (click)="slowPlay()" [disabled]="isPlayingAudio">
              <ion-icon name="musical-notes-outline" slot="start"></ion-icon>
              Slow Play
            </ion-button>
          </div>

          <div class="practice-controls">
            <ion-button fill="solid" color="primary" (click)="practicePattern()" [disabled]="isPracticing">
              <ion-icon name="mic-outline" slot="start"></ion-icon>
              {{ isPracticing ? 'Listening...' : 'Practice Recitation' }}
            </ion-button>
          </div>
        </div>
      </div>
    </div>

    <!-- Pattern Sequence Overview -->
    <div class="sequence-overview">
      <h4>Braid Sequence Progress</h4>
      <div class="sequence-timeline">
        <div class="timeline-step" 
             *ngFor="let step of currentPattern?.steps; let i = index"
             [class]="getStepStatus(i)"
             (click)="goToStep(i)">
          <div class="step-number">{{ i + 1 }}</div>
          <div class="step-preview">
            <div class="step-type-indicator" [class]="step.type">
              {{ getStepTypeSymbol(step.type) }}
            </div>
            <div class="step-text">{{ step.text }}</div>
          </div>
          <div class="step-status">
            <ion-icon [name]="getStepIcon(i)" [color]="getStepColor(i)"></ion-icon>
          </div>
        </div>
      </div>
    </div>

    <!-- Practice Feedback -->
    <div class="practice-feedback" *ngIf="practiceResult" [class]="practiceResult.rating">
      <div class="feedback-content" [class]="practiceResult.rating">
        <div class="feedback-icon">
          <ion-icon [name]="getFeedbackIcon()"></ion-icon>
        </div>
        <div class="feedback-message">
          <h4>{{ practiceResult.title }}</h4>
          <p>{{ practiceResult.message }}</p>
        </div>
      </div>
      <div class="feedback-actions">
        <ion-button fill="outline" (click)="retryPattern()" *ngIf="practiceResult.rating !== 'excellent'">
          <ion-icon name="refresh-outline" slot="start"></ion-icon>
          Try Again
        </ion-button>
        <ion-button fill="solid" color="success" (click)="nextPattern()" *ngIf="practiceResult.rating === 'excellent'">
          <ion-icon name="checkmark-outline" slot="start"></ion-icon>
          Next Pattern
        </ion-button>
      </div>
    </div>

    <!-- Navigation Controls -->
    <div class="navigation-controls">
      <ion-button fill="outline" (click)="previousPattern()" [disabled]="currentPatternIndex === 0">
        <ion-icon name="chevron-back-outline" slot="start"></ion-icon>
        Previous
      </ion-button>
      <ion-button fill="outline" (click)="resetTraining()">
        <ion-icon name="refresh-outline" slot="start"></ion-icon>
        Reset
      </ion-button>
      <ion-button fill="solid" color="primary" (click)="nextPattern()" [disabled]="!canProceed()">
        Next
        <ion-icon name="chevron-forward-outline" slot="end"></ion-icon>
      </ion-button>
    </div>
  </div>

  <!-- Completion Section -->
  <div class="completion-section" *ngIf="isCompleted">
    <ion-card class="completion-card">
      <div class="completion-animation">
        <ion-icon name="trophy-outline" color="warning"></ion-icon>
        <div class="celebration-text">üéâ Braided Mastery Achieved! üéâ</div>
      </div>
      
      <h3>JatƒÅ PƒÅ·π≠ha Complete!</h3>
      <p>
        Excellent work! You have mastered the intricate braided recitation method. 
        This advanced technique has strengthened your memory pathways and prepared you for even more sophisticated Vedic methods.
      </p>

      <div class="completion-stats">
        <div class="stat-item">
          <ion-icon name="git-branch-outline"></ion-icon>
          <span>{{ totalPatterns }} Patterns Mastered</span>
        </div>
        <div class="stat-item">
          <ion-icon name="time-outline"></ion-icon>
          <span>{{ getCompletionTime() }} Training Time</span>
        </div>
        <div class="stat-item">
          <ion-icon name="star-outline"></ion-icon>
          <span>{{ getAccuracyScore() }}% Accuracy</span>
        </div>
      </div>

      <div class="completion-actions">
        <ion-button fill="outline" (click)="restartTraining()">
          <ion-icon name="refresh-outline" slot="start"></ion-icon>
          Practice Again
        </ion-button>
        <ion-button fill="solid" color="success" routerLink="/ghanapada">
          <ion-icon name="arrow-forward-outline" slot="end"></ion-icon>
          Try Ghana PƒÅ·π≠ha
        </ion-button>
        <ion-button fill="clear" routerLink="/home">
          <ion-icon name="home-outline" slot="start"></ion-icon>
          Back to Home
        </ion-button>
      </div>
    </ion-card>
  </div>

  <!-- Advanced Tips Section -->
  <div class="tips-section">
    <h2>Mastery Tips for JatƒÅ PƒÅ·π≠ha</h2>
    
    <div class="tips-grid">
      <div class="tip-card">
        <ion-icon name="git-branch-outline" color="primary"></ion-icon>
        <h4>Pattern Visualization</h4>
        <p>Visualize each braid pattern as an actual woven structure. This mental imagery helps maintain the complex sequences.</p>
      </div>

      <div class="tip-card">
        <ion-icon name="refresh-outline" color="primary"></ion-icon>
        <h4>Reverse Practice</h4>
        <p>Master both forward and reverse sequences equally. The bidirectional flow is essential for true JatƒÅ mastery.</p>
      </div>

      <div class="tip-card">
        <ion-icon name="speedometer-outline" color="warning"></ion-icon>
        <h4>Gradual Speed</h4>
        <p>Start slowly and maintain perfect accuracy. Speed will naturally increase as the patterns become automatic.</p>
      </div>

      <div class="tip-card">
        <ion-icon name="heart-outline" color="success"></ion-icon>
        <h4>Patience & Practice</h4>
        <p>JatƒÅ PƒÅ·π≠ha is the most complex method before Ghana. Be patient with yourself and practice regularly.</p>
      </div>

      <div class="tip-card">
        <ion-icon name="musical-notes-outline" color="tertiary"></ion-icon>
        <h4>Rhythmic Flow</h4>
        <p>Develop a natural rhythm for each pattern. The musical quality helps maintain the intricate sequences.</p>
      </div>

      <div class="tip-card">
        <ion-icon name="diamond-outline" color="medium"></ion-icon>
        <h4>Mindful Concentration</h4>
        <p>This method requires deep focus. Practice in a quiet environment and maintain complete attention.</p>
      </div>
    </div>
  </div>
</ion-content>
