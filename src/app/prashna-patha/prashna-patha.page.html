<app-technique-header 
  title="Prashna PƒÅ·π≠ha" 
  sanskrit="‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡§æ‡§†" 
  emoji="ü§î"
  color="primary" 
  [translucent]="true" 
  [showMenuButton]="true">
</app-technique-header>

<ion-content [fullscreen]="true" class="prashna-content">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">ü§î Prashna PƒÅ·π≠ha</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-content">
      <h2>‚ùì Questions Lead to Answers</h2>
      <p class="hero-description">
        Life throws challenges at you every day. You face confusion, fear, anger, and tough decisions. 
        The <strong>Bhagavad Gƒ´tƒÅ</strong> has already answered these questions thousands of years ago. 
        Discover the wisdom that speaks directly to <em>your</em> life situation.
      </p>
      <div class="hero-stats">
        <div class="stat-item">
          <ion-icon name="help-circle-outline" color="primary"></ion-icon>
          <span>{{totalQuestions}} Life Questions</span>
        </div>
        <div class="stat-item">
          <ion-icon name="book-outline" color="secondary"></ion-icon>
          <span>{{totalSlokas}} Relevant Slokas</span>
        </div>
        <div class="stat-item">
          <ion-icon name="heart-outline" color="tertiary"></ion-icon>
          <span>Real Situations</span>
        </div>
      </div>
    </div>
  </div>

  <!-- How It Works Section -->
  <div class="how-it-works">
    <h3>üí° How This Works</h3>
    <div class="steps-container">
      <div class="step">
        <div class="step-number">1</div>
        <ion-icon name="help-circle" color="primary"></ion-icon>
        <h4>Find Your Question</h4>
        <p>Browse real-life situations or search for your specific challenge</p>
      </div>
      <div class="step">
        <div class="step-number">2</div>
        <ion-icon name="book" color="secondary"></ion-icon>
        <h4>Discover the Answer</h4>
        <p>Read the relevant Bhagavad Gƒ´tƒÅ sloka with meaning and practical application</p>
      </div>
      <div class="step">
        <div class="step-number">3</div>
        <ion-icon name="headset" color="tertiary"></ion-icon>
        <h4>Memorize with Purpose</h4>
        <p>When a sloka answers YOUR question, you'll naturally want to remember it</p>
      </div>
      <div class="step">
        <div class="step-number">4</div>
        <ion-icon name="sparkles" color="success"></ion-icon>
        <h4>Apply in Life</h4>
        <p>Use this wisdom when you face similar situations in the future</p>
      </div>
    </div>
  </div>

  <!-- Search Bar -->
  <div class="search-section">
    <ion-searchbar 
      [(ngModel)]="searchTerm"
      (ionInput)="onSearch()"
      placeholder="Search for your life situation..."
      mode="ios"
      animated="true"
      [debounce]="500">
    </ion-searchbar>
  </div>

  <!-- Category Filters -->
  <div class="category-section">
    <h3>üè∑Ô∏è Browse by Category</h3>
    <div class="category-chips">
      <ion-chip 
        [class.active]="selectedCategory === ''"
        (click)="filterByCategory('')"
        color="medium">
        <ion-icon name="apps-outline"></ion-icon>
        <ion-label>All ({{totalQuestions}})</ion-label>
      </ion-chip>
      <ion-chip 
        *ngFor="let category of categories"
        [class.active]="selectedCategory === category.name"
        (click)="filterByCategory(category.name)"
        [color]="category.color">
        <ion-icon [name]="category.icon"></ion-icon>
        <ion-label>{{category.name}} ({{category.questionCount}})</ion-label>
      </ion-chip>
    </div>
  </div>

  <!-- Questions Grid -->
  <div class="questions-section">
    <div class="section-header">
      <h3>üìñ Life Questions & Gƒ´tƒÅ Answers</h3>
      <ion-button fill="outline" size="small" (click)="openAddQuestionModal()">
        <ion-icon name="add-circle-outline" slot="start"></ion-icon>
        Add Your Question
      </ion-button>
    </div>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="isLoading">
      <ion-spinner name="crescent" color="primary"></ion-spinner>
      <p>Loading questions...</p>
    </div>

    <!-- No Results State -->
    <div class="no-results" *ngIf="!isLoading && filteredQuestions.length === 0">
      <ion-icon name="search-outline" color="medium"></ion-icon>
      <h4>No questions found</h4>
      <p *ngIf="searchTerm">Try a different search term or browse by category</p>
      <p *ngIf="selectedCategory && !searchTerm">No questions in this category yet</p>
      <ion-button fill="outline" (click)="openAddQuestionModal()">
        Add Your Own Question
      </ion-button>
    </div>

    <!-- Questions Grid -->
    <div class="questions-grid" *ngIf="!isLoading && filteredQuestions.length > 0">
      <ion-card 
        *ngFor="let question of filteredQuestions" 
        class="question-card"
        [class.custom-question]="question.isCustom"
        (click)="openQuestion(question.id)">
        
        <!-- Category Badge -->
        <div class="category-badge" [attr.data-category]="question.category">
          <ion-icon [name]="getCategoryIcon(question.category)"></ion-icon>
          {{question.category}}
        </div>

        <!-- Difficulty Badge -->
        <div class="difficulty-badge" [attr.data-difficulty]="question.difficulty">
          <ion-icon name="cellular-outline"></ion-icon>
          {{question.difficulty}}
        </div>

        <!-- Custom Badge -->
        <div class="custom-badge" *ngIf="question.isCustom">
          <ion-icon name="person-outline"></ion-icon>
          Your Question
        </div>

        <ion-card-header>
          <ion-card-title>
            <ion-icon name="help-circle-outline" color="primary"></ion-icon>
            {{question.question}}
          </ion-card-title>
        </ion-card-header>

        <ion-card-content>
          <!-- Situation Preview -->
          <div class="situation-preview">
            <p>{{question.situation.length > 120 ? question.situation.substring(0, 120) + '...' : question.situation}}</p>
          </div>

          <!-- Related Slokas -->
          <div class="sloka-info">
            <ion-icon name="book-outline" color="secondary"></ion-icon>
            <span>{{question.relatedSlokas.length}} Relevant Sloka{{question.relatedSlokas.length > 1 ? 's' : ''}}</span>
            <span class="chapter-info">
              ‚Ä¢ BG {{question.relatedSlokas[0].chapter}}.{{question.relatedSlokas[0].verse}}
              <span *ngIf="question.relatedSlokas.length > 1"> +{{question.relatedSlokas.length - 1}} more</span>
            </span>
          </div>

          <!-- Read More Button -->
          <ion-button 
            expand="block" 
            fill="outline" 
            size="small"
            class="read-more-btn">
            <ion-icon name="arrow-forward-outline" slot="end"></ion-icon>
            Find the Answer
          </ion-button>
        </ion-card-content>
      </ion-card>
    </div>
  </div>

  <!-- Floating Action Button for Add Question -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button (click)="openAddQuestionModal()" color="primary">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- Info Footer -->
  <div class="info-footer">
    <ion-card>
      <ion-card-content>
        <h4>‚ú® Why Question-Based Learning?</h4>
        <p>
          Traditional memorization feels mechanical. But when a sloka <strong>answers your personal question</strong>, 
          it becomes meaningful. You're not just memorizing words - you're finding solutions. This emotional connection 
          makes the verse stick in your memory naturally and gives you practical wisdom for life.
        </p>
        <p class="encouragement">
          <ion-icon name="heart" color="danger"></ion-icon>
          Don't see your question? Add it! Help others who face similar challenges.
        </p>
      </ion-card-content>
    </ion-card>
  </div>

</ion-content>
